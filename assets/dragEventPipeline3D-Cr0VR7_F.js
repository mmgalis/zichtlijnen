import{cD as N,cE as m,cF as E,cG as S,cH as R,cI as y,b7 as $,c7 as i,cJ as G,cK as H,cL as I,cM as g,cN as T,cO as P,c4 as O,cP as w,cQ as U,cR as b,cS as F,cT as h,cU as A,cV as k,cW as q,cv as J,cw as K,cX as _,cY as v,cZ as j}from"./index-CY8jQoH7.js";function z(n,r){return C(n,()=>r)}function Y(n){return C(n,r=>r.plane)}function C(n,r){const t=i(),l=i();let s=!1;return e=>{const c=r(e);if(e.action==="start"){const u=m(e.screenStart,E(S.get())),o=R(n.state.camera,u,x);o!=null&&(s=y(c,o,t))}if(!s)return null;const a=m(e.screenEnd,E(S.get())),d=R(n.state.camera,a,x);return d==null?null:y(c,d,l)?{...e,renderStart:t,renderEnd:l,plane:c,ray:d}:null}}function B(n,r,t=0,l=null,s=null){let e=null;return c=>{if(c.action==="start"&&(e=n.sceneIntersectionHelper.intersectElevationFromScreen(g(c.screenStart.x,c.screenStart.y),r,t,s),e!=null&&l!=null&&!T(e,e,l))||e==null)return null;const a=n.sceneIntersectionHelper.intersectElevationFromScreen(g(c.screenEnd.x,c.screenEnd.y),r,t,s);return a!=null&&(l==null||T(a,a,l))?{...c,mapStart:e,mapEnd:a}:null}}function L(n,r,t,l=null,s=null){return B(n,t,G(r,n,t),l,s)}function Z(n,r,t,l){const s=t.toMap(n.screenStart);return s!=null?L(r,s,t.elevationInfo,l):null}function Q(n,r){const t=D,l=M,s=P();n.renderCoordsHelper.worldUpAtPosition(r,t);const e=O(U(s),t,w(l,r,n.state.camera.eye));return O(e,e,t),b(r,e,s)}function nn(n,r,t){let l=null;const s=new F;return s.next(z(n,Q(n,r))).next(V(n,r)).next(W(n,t)).next(e=>{e.mapEnd.x=e.mapStart.x,e.mapEnd.y=e.mapStart.y,l=e}),e=>(l=null,s.execute(e),l)}function V(n,r){const t=i(),l=H(r);n.renderCoordsHelper.worldUpAtPosition(r,t);const s=i(),e=i(),c=a=>(w(a,a,r),h(t,a,a),n.viewingMode==="global"&&H(a)*Math.sign(A(t,a))<.001-l&&w(a,k(a,t,.001),r),q(a,a,r),a);return a=>(a.renderStart=c(I(s,a.renderStart)),a.renderEnd=c(I(e,a.renderEnd)),a)}function en(n,r){const t=l=>{const s=m(l,E(S.get())),e=R(n.state.camera,s,x);return e==null?null:_(r,e,D,M)[1]};return l=>{const s=t(l.screenStart);if(s==null)return null;const e=t(l.screenEnd);return e==null?null:{...l,renderStart:s,renderEnd:e}}}function W(n,r){const t=n.renderCoordsHelper;return l=>{const s=t.fromRenderCoords(l.renderStart,new $({spatialReference:r})),e=t.fromRenderCoords(l.renderEnd,new $({spatialReference:r}));return s!=null&&e!=null?{...l,mapStart:s,mapEnd:e}:null}}var f;function tn(n){let r=null;return t=>{switch(t.action){case"start":r=n.disableDisplay();break;case"end":case"cancel":r!=null&&(r.remove(),r=null)}return t}}function rn(n,r=null){const t=J(n.state.viewingMode);t.options.selectionMode=!0,t.options.store=K.MIN,t.options.hud=!1;const l=g(),s={requiresGroundFeedback:!0,enableDraped:!0,exclude:new Set},e=i(),c=r??n.spatialReference,a=u=>{n.map.ground&&n.map.ground.opacity<1?s.exclude.add(v):s.exclude.delete(v),n.sceneIntersectionHelper.intersectIntersectorScreen(m(u,l),t,s);const o=t.results.min;let p;if(o.getIntersectionPoint(e))p=o.intersector===j.TERRAIN?f.GROUND:f.OTHER;else{if(!t.results.ground.getIntersectionPoint(e))return null;p=f.GROUND}return{location:n.renderCoordsHelper.fromRenderCoords(e,new $({spatialReference:c})),surfaceType:p}};let d;return u=>{if(u.action==="start"){const p=a(u.screenStart);d=p!=null?p.location:null}if(d==null)return null;const o=a(u.screenEnd);return(o==null?void 0:o.location)!=null?{...u,mapStart:d,mapEnd:o.location,surfaceType:o.surfaceType}:null}}(function(n){n[n.GROUND=0]="GROUND",n[n.OTHER=1]="OTHER"})(f||(f={}));const D=i(),M=i(),x=N();export{W as A,Y as C,L as D,nn as G,Z as M,z as O,en as k,tn as q,rn as z};
